<template>
  <div class="r-drawer">
    <div class="drawer-mask" @click="close_drawer" v-show="value"></div>
    <!-- <transition name="fade"> -->
    <div class="drawer-block" :class="side" v-show="value">
      <div class="drawer-header">
        <!-- <slot name="header"></slot> -->
        <div class="drawer-close-label" v-if="closeable" @click="close_drawer">
          <div class="drawer-close-icon">
            <Icon type="md-close" />
          </div>
        </div>
      </div>
      <div class="drawer-content">
        <slot name="content"></slot>
      </div>
    </div>
    <!-- </transition> -->
  </div>
</template>

<script>
import ModalHelper from '../../util/modal_helper'
export default {
  name: 'RDrawer',
  props: {
    closeable: {
      type: Boolean,
      default: true
    }, // 是否可关闭
    value: {
      type: Boolean,
      default: false
    },
    side: {
      type: String,
      default: 'left',
      validator (value) {
        return ['top', 'right', 'bottom', 'left'].includes(value)
      }
    }
  },
  model:{
    prop: 'value',
    event: 'change'  // 自定义方法，用来更新 model
  },
  data () {
    return {
    }
  },
  methods: {
    // 关闭
    close_drawer () {
      this.$emit('change', false)
    },
    // 显示&隐藏
    visible_change () {
      if (this.value) {
        ModalHelper.afterOpen()
      } else {
        ModalHelper.beforeClose()
      }
      this.$emit('visible_change', this.value)
    }
  },
  watch: {
    value (newVal) {
      this.visible_change()
    }
  }
}
</script>

<style>
.elsass-fade-enter-active, .elsass-fade-leave-active {
  transition: opacity 1s
}
.elsass-fade-enter, .elsass-fade-leave-to {
  opacity: 0
}

</style>