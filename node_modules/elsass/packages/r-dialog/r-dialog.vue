<template>
  <div v-show="value">
    <div class="leads-dialog-mask"></div>
    <div v-drag="{disable: disable, el: 'leads-out-dialog'}" id="leads-out-dialog" class="leads-out-dialog" :ref="'out_dialog'" :style="out_style">
      <div class="leads-dialog" :style="in_style">
        <div class="leads-dialog-header">
          <div class="dialog-title inline-block">{{title}}</div>
          <div class="dialog-close inline-block" v-if="closeable" @click="cancel">x</div>
        </div>
        <div class="leads-dialog-content" :style="content_style">
          <slot></slot>
        </div>
      </div>
    </div>
  </div>
</template>
<script>
export default {
  name: 'RDialog',
  props: {
    title: {
      type: String,
      default: '提示'
    },
    in_style: String,
    value: Boolean,
    mask_closable: Boolean,
    class_name: String,
    out_style: String,
    content_style: String,
    closeable: {
      type: Boolean,
      default () {
        return true
      }
    }, // 是否可以点击关闭
    disable: {
      type: Boolean,
      default: true
    }
  },
  data () {
    return {
      name: 'r-dialog'
    }
  },
  directives: {
    drag (el, bindings) {
      if (bindings.value && bindings.value.disable) {
        return false
      }
      // let elM = document.getElementById('leads-out-dialog')
      el.onmousedown = function (e) {
        let disx = e.pageX - el.offsetLeft
        let disy = e.pageY - el.offsetTop
        document.onmousemove = function (e) {
          el.style.left = e.pageX - disx + 'px'
          el.style.top = e.pageY - disy + 'px'
        }
        document.onmouseup = function () {
          document.onmousemove = document.onmouseup = null
        }
      }
    }
  },
  computed: {
  },
  mounted () {
  },
  created () {
  },
  methods: {
    cancel () {
      this.$emit('on-close')
    }
  },
  watch: {
    value (newVal) {
      if (newVal) {
        this.$refs.out_dialog.style.paddingTop = '5%'
        this.$refs.out_dialog.style.left = 0
      }
    }
  }
}
</script>
