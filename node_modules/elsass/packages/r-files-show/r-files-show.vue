<template>
  <!-- 附件列表展示 -->
  <div class="files-list" v-show="filesList.length > 0">
    <div class="file-info" v-for="(file, index) in filesList" :key="`file-${index}`" @mouseout="handleMouseOut" @mousemove="handleMouseover(index)">
      <div class="file-img">
        <img :src="getShowImg(file).url" :style="getShowImg(file).style"/>
      </div>
      <div v-if="downLoad" class="file-name">
        <a :href="file.file_host + file.file_path" download target="_blank">{{ file.file_path.split('/').pop() }}</a>
      </div>
      <div v-else class="file-name">
        {{ file.file_path.split('/').pop() }}
      </div>
      <img v-if="drop" v-show="active === index" @click="dropFile(index)" class="file-delete-img" src="../../src/assets/images/delete-doc.png">
    </div>
  </div>
</template>

<script>
export default {
  name: 'r-files-show',
  data () {
    return {
      active: -1
    }
  },
  props: {
    filesList: {
      type: Array,
      default () {
        return []
      }
    },
    // 是否支持删除
    drop: {
      type: Boolean,
      default () {
        return true
      }
    },
    // 是否支持下载
    downLoad: {
      type: Boolean,
      default () {
        return false
      }
    },
    // 文件服务器路径
    filesRoot: {
      type: String
    }
  },
  methods: {
    handleMouseover: function (index) {
      this.active = index
    },
    handleMouseOut: function () {
      this.active = -1
    },
    dropFile: function (index) {
      this.$emit('dropFile', index)
    },
    getShowImg (file) {
      // 获取文件的后缀名
      let name = (file.file_path || '').split('.').pop()
      let img = {
        url: require('../../src/assets/images/default.png'),
        style: 'width: 50px;height: 50px'
      }
      switch (name.toLowerCase()) {
        case 'img': case 'image': case 'png': case 'jpg': case 'jpeg': case 'gif':
          img = {
            url: file.file_host ? file.file_host + file.file_path : file.file_path,
            style: 'width: 95px;height: 77px'
          }
          break
        case 'txt':
          img = {
            url: require('../../src/assets/images/txt.png'),
            style: 'width: 60px;height: 50px'
          }
          break
        case 'doc': case 'docx': case 'rtf':
          img = {
            url: require('../../src/assets/images/word.png'),
            style: 'width: 50px;height: 50px'
          }
          break
        case 'zip': case 'rar':
          img = {
            url: require('../../src/assets/images/zip.png'),
            style: 'width: 53px;height: 53px'
          }
          break
        case 'xlsx': case 'xls':
          img = {
            url: require('../../src/assets/images/xls.png'),
            style: 'width: 56px;height: 53px'
          }
          break
        case 'ppt': case 'pptx':
          img = {
            url: require('../../src/assets/images/ppt.png'),
            style: 'width: 56px;height: 53px'
          }
          break
      }
      return img
    }
  }
}
</script>

<style scoped>
  .files-list {
    border: 1px solid #E3E3E3;
    display: inline-block;
    border-radius: 4px;
  }
  .files-list .file-info {
    width: 170px;
    height: 163px;
    margin: 9px 6px 9px 9px;
    float: left;
    padding: 4px 6px;
    border: solid 1px transparent;
  }
  .files-list .file-info:hover {
    /* border: 1px solid #999999; */
    background-color: #ECF3FF;
  }
  .files-list .file-img {
    width: 155px;
    height: 111px;
    margin: 6px 7px;
    border: 1px solid #E3E3E3;
    text-align: center;
    display: table-cell
  }
  .files-list .file-name {
    text-align: center;
    float: left;
    margin-left: 8px;
    width: 155px;
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
    color: #1866A6;
    font-size: 14px;
  }
  .file-delete-img {
    width: 11px;
    height: 15px;
    float: right;
    margin: 0 2px 2px 0px;
  }
  .file-img img {
    margin: 15px 30px;
  }
</style>


